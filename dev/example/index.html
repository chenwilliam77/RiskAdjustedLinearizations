<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example · RiskAdjustedLinearizations.jl</title><link rel="canonical" href="https://juliadocs.github.io/Documenter.jl/stable/example/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">RiskAdjustedLinearizations.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../risk_adjusted_linearization/">Risk-Adjusted Linearizations</a></li><li><a class="tocitem" href="../numerical_algorithms/">Numerical Algorithms</a></li><li class="is-active"><a class="tocitem" href>Example</a><ul class="internal"><li><a class="tocitem" href="#Create-a-RiskAdjustedLinearization-1"><span>Create a <code>RiskAdjustedLinearization</code></span></a></li><li><a class="tocitem" href="#Solve-using-a-Newton-type-Numerical-Algorithm-1"><span>Solve using a Newton-type Numerical Algorithm</span></a></li><li><a class="tocitem" href="#[Additional-Examples](@ref-listexample)-1"><span>Additional Examples</span></a></li></ul></li><li><a class="tocitem" href="../caching/">Caching</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../tips/">Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/chenwilliam77/RiskAdjustedLinearizations.jl/blob/master/docs/src/example.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="example-1"><a class="docs-heading-anchor" href="#example-1">Example</a><a class="docs-heading-anchor-permalink" href="#example-1" title="Permalink"></a></h1><p>This example shows how to calculate the risk-adjusted linearization of the discrete-time version of the <a href="http://finance.wharton.upenn.edu/~jwachter/research/Wachter2013jf.pdf">Wachter (2013)</a> model with disaster-risk. You can run this example using the script <a href="https://github.com/chenwilliam77/RiskAdjustedLinearizations/tree/main/examples/wachter_disaster_risk/example_wachter.jl">examples/wachter_disaster_risk/example_wachter.jl</a>. For the equivalent code in MATLAB provided by Lopez et al., see <a href="https://github.com/fvazquezgrande/gen_affine/blob/main/examples/wac_disaster/genaffine_ezdis.m">here</a>. See <a href="@ref listexample">List of Examples</a> for short descriptions of and links to all examples in this package.</p><h2 id="Create-a-RiskAdjustedLinearization-1"><a class="docs-heading-anchor" href="#Create-a-RiskAdjustedLinearization-1">Create a <code>RiskAdjustedLinearization</code></a><a class="docs-heading-anchor-permalink" href="#Create-a-RiskAdjustedLinearization-1" title="Permalink"></a></h2><h3 id="Define-Nonlinear-System-1"><a class="docs-heading-anchor" href="#Define-Nonlinear-System-1">Define Nonlinear System</a><a class="docs-heading-anchor-permalink" href="#Define-Nonlinear-System-1" title="Permalink"></a></h3><p>The user generally needs to define</p><ul><li><span>$\mu$</span>: expected state transition function</li><li><span>$\xi$</span> nonlinear terms of the expectational equations</li><li>ccgf: conditional cumulant generating function of the exogenous shocks</li><li><span>$\Lambda$</span>: function or matrix mapping endogenous risk into state transition equations</li><li><span>$\Sigma$</span>: function or matrix mapping exogenous risk into state transition equations</li><li><span>$\Gamma_5$</span>: coefficient matrix on one-period ahead expectation of state variables</li><li><span>$\Gamma_6$</span>: coefficient matrix on one-period ahead expectation of jump variables</li></ul><p>The quantities <span>$\mu$</span>, <span>$\xi$</span>, and ccgf are always functions. The quantities <span>$\Lambda$</span> and <span>$\Sigma$</span> can either be functions or matrices. For example, in endowment economies like Wachter (2013), <span>$\Lambda$</span> is the zero matrix since there is no endogenous risk. In other applications, <span>$\Sigma$</span> may not be state-dependent and thus a constant matrix. The last two quantities <span>$\Gamma_5$</span> and <span>$\Gamma_6$</span> are always matrices. These functions do not need to have type assertions for the inputs, but if the user wants to add type assertions, then the types should be <code>AbstractVector{T}</code>, <code>AbstractMatrix{T}</code>, or <code>AbstractArray{T}</code> where <code>T</code> should allow any subtypes of <code>Real</code> to permit automatic differentiation, e.g. <code>AbstractVector{T} where T &lt;: Real</code>. If more specific types than <code>AbstractVector</code>, etc., are used, then <code>RiskAdjustedLinearization</code> may not work properly. For these reasons, it is recommended that type assertions are not added unless necessary.</p><p>In addition, you need to define initial guesses for the coefficients <code>z, y, Ψ</code> and specify the number of exogenous shocks <code>Nε</code>. The initial guesses can be undefined if you don&#39;t want to use actual numbers yet, but you will eventually need to provide guesses in order for the nonlinear solvers to work in the numerical algorithms.</p><h3 id="Instantiate-the-object-1"><a class="docs-heading-anchor" href="#Instantiate-the-object-1">Instantiate the object</a><a class="docs-heading-anchor-permalink" href="#Instantiate-the-object-1" title="Permalink"></a></h3><p>Once you have the required quantities, simply call</p><pre><code class="language-none">ral = RiskAdjustedLinearization(μ, Λ, Σ, ξ, Γ₅, Γ₆, ccgf, z, y, Ψ, Nε)</code></pre><h3 id="Example-1"><a class="docs-heading-anchor" href="#Example-1">Example</a><a class="docs-heading-anchor-permalink" href="#Example-1" title="Permalink"></a></h3><p>The following code presents a function that defines the desired functions and matrices, given the parameters for the model in Wachter (2013), and returns a <code>RiskAdjustedLinearization</code> object. The code is from this script <a href="https://github.com/chenwilliam77/RiskAdjustedLinearizations/tree/main/examples/wachter_disaster_risk/wachter.jl">examples/wachter_disaster_risk/wachter.jl</a>, which has examples for both in-place and out-of-place functions.</p><pre><code class="language-none">function inplace_wachter_disaster_risk(m::WachterDisasterRisk{T}) where {T &lt;: Real}
    @unpack μₐ, σₐ, ν, δ, ρₚ, pp, ϕₚ, ρ, γ, β = m

    @assert ρ != 1. # Forcing ρ to be non-unit for this example

    S  = OrderedDict{Symbol, Int}(:p =&gt; 1,  :εc =&gt; 2, :εξ =&gt; 3) # State variables
    J  = OrderedDict{Symbol, Int}(:vc =&gt; 1, :xc =&gt; 2, :rf =&gt; 3) # Jump variables
    SH = OrderedDict{Symbol, Int}(:εₚ =&gt; 1, :εc =&gt; 2, :εξ =&gt; 3) # Exogenous shocks
    Nz = length(S)
    Ny = length(J)
    Nε = length(SH)

    function μ(F, z, y)
        F_type    = eltype(F)
        F[S[:p]]  = (1 - ρₚ) * pp + ρₚ * z[S[:p]]
        F[S[:εc]] = zero(F_type)
        F[S[:εξ]] = zero(F_type)
    end

    function ξ(F, z, y)
        F[J[:vc]] = log(β) - γ * μₐ + γ * ν * z[S[:p]] - (ρ - γ) * y[J[:xc]] + y[J[:rf]]
        F[J[:xc]] = log(1. - β + β * exp((1. - ρ) * y[J[:xc]])) - (1. - ρ) * y[J[:vc]]
        F[J[:rf]] = (1. - γ) * (μₐ - ν * z[S[:p]] - y[J[:xc]])
    end

    Λ = zeros(T, Nz, Ny)

    function Σ(F, z)
        F_type = eltype(F)
        F[SH[:εₚ], SH[:εₚ]] = sqrt(z[S[:p]]) * ϕₚ * σₐ
        F[SH[:εc], SH[:εc]] = one(F_type)
        F[SH[:εξ], SH[:εξ]] = one(F_type)
    end

    function ccgf(F, α, z)
        F .= .5 .* α[:, 1].^2 + .5 * α[:, 2].^2 + (exp.(α[:, 3] + α[:, 3].^2 .* δ^2 ./ 2.) .- 1. - α[:, 3]) * z[S[:p]]
    end

    Γ₅ = zeros(T, Ny, Nz)
    Γ₅[J[:vc], S[:εc]] = (-γ * σₐ)
    Γ₅[J[:vc], S[:εξ]] = (γ * ν)
    Γ₅[J[:rf], S[:εc]] = (1. - γ) * σₐ
    Γ₅[J[:rf], S[:εξ]] = -(1. - γ) * ν

    Γ₆ = zeros(T, Ny, Ny)
    Γ₆[J[:vc], J[:vc]] = (ρ - γ)
    Γ₆[J[:rf], J[:vc]] = (1. - γ)

    z = [pp, 0., 0.]
    xc_sss = log((1. - β) / (exp((1. - ρ) * (ν * pp - μₐ)) - β)) / (1. - ρ)
    vc_sss = xc_sss + ν * pp - μₐ
    y = [vc_sss, xc_sss, -log(β) + γ * (μₐ - ν * pp) - (ρ - γ) * (vc_sss - xc_sss)]
    Ψ = zeros(T, Ny, Nz)
    return RiskAdjustedLinearization(μ, Λ, Σ, ξ, Γ₅, Γ₆, ccgf, z, y, Ψ, Nε)
end</code></pre><h2 id="Solve-using-a-Newton-type-Numerical-Algorithm-1"><a class="docs-heading-anchor" href="#Solve-using-a-Newton-type-Numerical-Algorithm-1">Solve using a Newton-type Numerical Algorithm</a><a class="docs-heading-anchor-permalink" href="#Solve-using-a-Newton-type-Numerical-Algorithm-1" title="Permalink"></a></h2><p>To solve the model using the relaxation algorithm, just call</p><pre><code class="language-none">solve!(ral; algorithm = :relaxation)</code></pre><p>This form of <code>solve!</code> uses the coefficients in <code>ral</code> as initial guesses. To specify other initial guesses, call</p><pre><code class="language-none">solve!(ral, z0, y0, Ψ0; algorithm = :relaxation)</code></pre><p>If you don&#39;t have a guess for <span>$\Psi$</span>, then you can just provide guesses for <span>$z$</span> and <span>$y$</span>:</p><pre><code class="language-none">solve!(ral, z0, y0; algorithm = :relaxation)</code></pre><p>In this case, we calculate the deterministic steady state first using <span>$z$</span> and <span>$y$</span>; back out the implied <span>$\Psi$</span>; and then proceed with the relaxation algorithm using the deterministic steady state as the initial guess.</p><h2 id="[Additional-Examples](@ref-listexample)-1"><a class="docs-heading-anchor" href="#[Additional-Examples](@ref-listexample)-1"><a href="@ref listexample">Additional Examples</a></a><a class="docs-heading-anchor-permalink" href="#[Additional-Examples](@ref-listexample)-1" title="Permalink"></a></h2><ul><li><p><a href="https://github.com/chenwilliam77/RiskAdjustedLinearizations.jl/blob/main/examples/wachter_disaster_risk/example_wachter.jl">Wachter (2013)</a>: discrete-time model with Epstein-Zin preferences and disaster risk (as a Poisson mixture of normals); demonstrates how to use both in-place and out-of-place functions with <code>RiskAdjustedLinearization</code></p></li><li><p><a href="https://github.com/chenwilliam77/RiskAdjustedLinearizations.jl/blob/main/examples/rbc_cc/example_rbc_cc.jl">Jermann (1998)/Chen (2017)</a>: RBC model with Campbell-Cochrane habits and multi-period approximation of forward difference equations</p></li><li><p><a href="https://github.com/chenwilliam77/RiskAdjustedLinearizations.jl/blob/main/examples/textbook_nk/example_textbook_nk.jl">Textbook New Keynesian Model</a>: cashless limit of Gali (2015) textbook model with a simple Taylor rule. A Dynare script is also provided for comparison.</p></li><li><p><a href="https://github.com/chenwilliam77/RiskAdjustedLinearizations/tree/main/examples/crw/example_crw.jl">Coeurdacier, Rey, Winant (2011)</a>: small-open economy model whose deterministic steady state does not exist. Example also provides a tutorial on calculating Euler equation errors.</p></li><li><p><a href="https://github.com/chenwilliam77/RiskAdjustedLinearizations.jl/blob/main/examples/textbook_nk/example_textbook_nk.jl">New Keynesian Model with Capital</a>: cashless limit of Gali (2015) textbook model with capital accumulation, capital adjustment costs, additional shocks, and a Taylor rule on both inflation and output growth. A Dynare script is also provided for comparison.</p></li><li><p><a href="https://github.com/chenwilliam77/RiskAdjustedLinearizations.jl/tree/main/examples/matlab_timing_test">MATLAB Timing Test</a>: compare speed of Julia to MATLAB for Jermann (1998) and Wachter (2013) examples</p></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../numerical_algorithms/">« Numerical Algorithms</a><a class="docs-footer-nextpage" href="../caching/">Caching »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 7 January 2021 01:03">Thursday 7 January 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
